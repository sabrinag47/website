"0","library(glmnet)"
"0","class_diag<-function(probs,truth){ "
"0","  tab<-table(factor(probs>.5,levels=c(""FALSE"",""TRUE"")),truth)  "
"0","  acc=sum(diag(tab))/sum(tab)  "
"0","  sens=tab[2,2]/colSums(tab)[2]  "
"0","  spec=tab[1,1]/colSums(tab)[1]  "
"0","  ppv=tab[2,2]/rowSums(tab)[2]  "
"0","  if(is.numeric(truth)==FALSE & is.logical(truth)==FALSE) "
"0","    truth<-as.numeric(truth)-1  "
"0","  ord<-order(probs, decreasing=TRUE)  "
"0","  probs <- probs[ord]; truth <- truth[ord]  "
"0","  TPR=cumsum(truth)/max(1,sum(truth))   "
"0","  FPR=cumsum(!truth)/max(1,sum(!truth))  "
"0","  dup<-c(probs[-1]>=probs[-length(probs)], FALSE)  "
"0","  TPR<-c(0,TPR[!dup],1); FPR<-c(0,FPR[!dup],1)  "
"0","  n <- length(TPR)  "
"0","  auc<- sum( ((TPR[-1]+TPR[-n])/2) * (FPR[-1]-FPR[-n]) )  "
"0","  data.frame(acc,sens,spec,ppv,auc)"
"0","  } "
"0",""
"0","prob<-predict(fit4,type=""response"")"
"0",""
"0","class_diag(prob,bird2$y)"
